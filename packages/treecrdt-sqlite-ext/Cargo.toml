[package]
name = "treecrdt-sqlite-ext"
version = "0.0.1"
edition = "2021"
license = "MIT"
description = "SQLite / wa-sqlite extension harness for TreeCRDT."

[lib]
crate-type = ["rlib", "staticlib"]

[dependencies]
blake3 = "1.6"
bincode = "1.3"
treecrdt-core = { path = "../treecrdt-core", features = ["serde"] }
rusqlite = { version = "0.31", features = ["bundled", "load_extension"], optional = true }
sqlite3ext-sys = { version = "0.0.1", optional = true }
serde = { version = "1.0", features = ["derive"] }
serde_json = { version = "1.0" }

[features]
default = ["rusqlite-storage"]
rusqlite-storage = ["dep:rusqlite"]
# Native loadable extension using sqlite3ext API table.
ext-sqlite = ["dep:sqlite3ext-sys"]
# Static-link extension for wasm/emscripten builds (no bundled SQLite C).
static-link = []
wasm-ext = ["static-link"]

[dev-dependencies]
tempfile = "3.10"
